<!DOCTYPE html><html lang='zh-CN'><head><meta charset='UTF-8'><meta name='viewport' content='width=device-width, initial-scale=1.0'><link rel='shortcut icon' href='/asset/favicon.png' type='image/x-icon'><meta name=description content='> 旧手机当网页web服务器，把Apache2 PHP phpMyAdmin MariaDB装进手机，可以访问PHP页面，通过phpMyAdmin访问数据库。适合有ROOT权限的手机。'/><link rel='stylesheet' href='/asset/main.css'/><link rel='stylesheet' href='/asset/page.css'/><title>[Termux]安卓手机当服务器使用 | 里克·博洛格</title></head><body><header><a class='title' href='/' target=_top><img src=/asset/avatar.jpg alt=avatar><p>里克·博洛格</p></a><p class='description'>品味百态人生</p></header><main><h1 id="安卓手机当服务器使用-termux-root">安卓手机当服务器使用 [Termux] [ROOT]</h1>
<p>A2024/11/27</p>
<blockquote>
<p>旧手机当网页web服务器，把Apache2 PHP phpMyAdmin MariaDB装进手机，可以访问PHP页面，通过phpMyAdmin访问数据库。适合有ROOT权限的手机。</p>
</blockquote>
<h3 id="下面开始安装-termux-app部署web运行环境">下面开始安装 Termux APP，部署web运行环境</h3>
<p>前提准备： - 已经root的安卓手机 - (没有root可以尝试解锁BL，刷入适合你手机的TWRP Recovery，再通过twrp刷入magisk，最后使用magisk进行ROOT授权)</p>
<p>下载 Termux APP - (推荐Google Play商店下载，或者GitHub)</p>
<h2 id="第一步前置部署">第一步：前置部署</h2>
<p>安装 <code>tsu</code> <code>vim</code> <code>apache2</code> <code>php</code> <code>php-fpm</code> <code>php-apache</code> <code>phpmyadmin</code> <code>mariadb</code></p>
<ul>
<li>更新可用软件包</li>
</ul>
<pre class="shell"><code>pkg upgrade</code></pre>
<ul>
<li>安装所有软件包</li>
</ul>
<pre class="shell"><code>pkg install tsu vim apache2 php php-fpm php-apache phpmyadmin mariadb</code></pre>
<p>在安装过程中需要确认安装，按“Y”回车。</p>
<h2 id="第二步配置环境">第二步：配置环境</h2>
<p>创建共享目录，方便Termux和Android的文件共享</p>
<pre class="shell"><code>termux-setup-storage</code></pre>
<h3 id="apache">Apache</h3>
<p>修改Apache配置文件 httpd.conf</p>
<pre class="shell"><code>vim /data/data/com.termux/files/usr/etc/apache2/httpd.conf</code></pre>
<p>进入vim编辑器后：按 ‘i’ 进入编辑模式。esc退出编辑。退出编辑后按 ‘:’ 进入命令模式。 ‘:q’ 退出vim编辑器。 ‘:exit’ 保存后退出。更多用法菜鸟教程Linux vi/vim</p>
<pre class="shell"><code>52|  Listen 80  #修改80端口

66|  LoadModule mpm_prefork_module...  #去掉开头的井号&quot;#&quot;

67|  #LoadModule mpm_worker_module... #在开头加上井号 &quot;#&quot;

#在162行下方新增代码。

162|  LoadModule php_module /data/data/com.termux/files/usr/libexec/apache2/libphp.so  

231|  Require all granted  #将 denied 修改为 granted

246|  DocumentRoot &quot;/storage/emulated/0/htdocs&quot;   #将这行代码中的路径替换成/storage/emulated/0/，这是你手机的主目录，可以随意指定

247|  &lt;Directory &quot;/storage/emulated/0/htdocs&quot; &gt;  #这行跟上一行的路径一样即可

#在261行下方新增代码。
261|  &lt;IfModule php_module&gt;
262|      php_flag magic_quotes_gpc Off
263|      php_flag track_vars On
264|      php_flag register_globals Off
265|      php_value include_pach .
266|  &lt;/IfModule&gt;

286|  DirectoryIndex index.php index.php3 index.html index.htm  #新增php,php3,htm后缀

#在423行下方新增代码。
423|  AddType application/x-httpd-php .php
424|  AddType application/x-httpd-php .php3</code></pre>
<p>保存httpd.conf后退出vim</p>
<p>运行 <code>sudo httpd</code> 启动apache服务</p>
<p>浏览器打开 <code>localhost</code> 访问。</p>
<p><code>sudo httpd -k stop</code> 用于停止apache服务</p>
<h3 id="mysql">MySql</h3>
<p>新开Termux会话，执行 <code>nohup mysqld &amp;</code> 或者直接执行 <code>mysqld</code> 运行数据库服务。</p>
<h3 id="phpmyadmin">phpMyAdmin</h3>
<p>修改phpmyadmin配置文件 config.inc.php</p>
<pre class="shell"><code>vim /data/data/com.termux/files/usr/etc/phpmyadmin/config.inc.php</code></pre>
<p>修改代码</p>
<pre class="shell"><code>30|  $cfg[&quot;Server&quot;][$i][&quot;host&quot;] = &#39;127.0.0.1&#39;  #将localhost 改为 127.0.0.1 以建立TCP连接
32|  $cfg[&quot;Server&quot;][$i][&quot;AllowNoPassword&quot;] =true  #将 false 改为 true 以允许空密码登录</code></pre>
<p>保存config.inc.php后退出vim</p>
<p>浏览器打开 <code>localhost/phpmyadmin</code> 访问。</p>
<p>新增phpmyadmin账户时将主机名的 <code>%</code> 改成 <code>127.0.0.1</code></p>
<p>安装程序时数据库地址填写 <code>127.0.0.1</code> PHP 修改php配置 php.ini</p>
<p>php配置文件在 /data/data/com.termux/files/usr/lib/php.ini</p>
<pre class="shell"><code>vim /data/data/com.termux/files/usr/lib/php.ini</code></pre>
<p>如果文件不存在执行下面代码</p>
<pre class="shell"><code>cp /data/data/com.termux/files/usr/share/doc/php/php.ini-production /data/data/com.termux/files/usr/lib/php.ini </code></pre>
<p>按需求修改即可。</p>
<h2 id="end">END</h2>
<p>先执行 <code>sudo httpd</code> 启动Apache服务再新开会话执行 <code>nohup mysqld &amp;</code> 启动mysql服务</p></main><footer><span>leek © 2024</span></footer><script src=/asset/main.js></script></body></html>
